/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.12/samples
 */

// Root project configuration for multi-project Gradle build with Ballerina integration

plugins {
    id "net.researchgate.release"
}

// Apply common configuration to all subprojects
allprojects {
    // Ensure all projects use the same version
    version = rootProject.version
}

// Convenience tasks that integrate with standard Gradle lifecycle
task runApiServer {
    description = 'Run the Ballerina API server'
    dependsOn ':api-server:runBallerina'
}

task buildDistribution {
    description = 'Build complete distribution with JAR and Docker image'
    dependsOn ':distribution:build'
}

// Release configuration
release {
    failOnCommitNeeded = false
    failOnPublishNeeded = false
    failOnSnapshotDependencies = true
    failOnUnversionedFiles = false
    failOnUpdateNeeded = false
    revertOnFail = true
    tagTemplate = 'v${version}'
    versionPropertyFile = 'gradle.properties'
    buildTasks = ['buildDistribution']
    requireBranch = '(main|master)'
}

// Configure release tasks
afterReleaseBuild.dependsOn buildDistribution
